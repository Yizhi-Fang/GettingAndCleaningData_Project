## Variable description

Variable name    | Description
-----------------|------------
subject          | Subject ID who performed the activity, ranging from 1 to 30
activityNum      | Activity number, ranging from 1 to 6
activityName     | Activity names including walking, walking_upstairs, walking_downstairs, sitting, standing and laying
featureName      | Column variables, only mean and standard deviation are selected for our case
data             | Cleaned data with measurements on the mean and standard deviation for each measurement
mean_data        | Average of each variable for each activity and each subject calculated from previous data

## The list of feature names

```{r}
feature$featureName
```

```{r}
"tBodyAcc-mean()-X"           "tBodyAcc-mean()-Y"          
 [3] "tBodyAcc-mean()-Z"           "tBodyAcc-std()-X"           
 [5] "tBodyAcc-std()-Y"            "tBodyAcc-std()-Z"           
 [7] "tGravityAcc-mean()-X"        "tGravityAcc-mean()-Y"       
 [9] "tGravityAcc-mean()-Z"        "tGravityAcc-std()-X"        
[11] "tGravityAcc-std()-Y"         "tGravityAcc-std()-Z"        
[13] "tBodyAccJerk-mean()-X"       "tBodyAccJerk-mean()-Y"      
[15] "tBodyAccJerk-mean()-Z"       "tBodyAccJerk-std()-X"       
[17] "tBodyAccJerk-std()-Y"        "tBodyAccJerk-std()-Z"       
[19] "tBodyGyro-mean()-X"          "tBodyGyro-mean()-Y"         
[21] "tBodyGyro-mean()-Z"          "tBodyGyro-std()-X"          
[23] "tBodyGyro-std()-Y"           "tBodyGyro-std()-Z"          
[25] "tBodyGyroJerk-mean()-X"      "tBodyGyroJerk-mean()-Y"     
[27] "tBodyGyroJerk-mean()-Z"      "tBodyGyroJerk-std()-X"      
[29] "tBodyGyroJerk-std()-Y"       "tBodyGyroJerk-std()-Z"      
[31] "tBodyAccMag-mean()"          "tBodyAccMag-std()"          
[33] "tGravityAccMag-mean()"       "tGravityAccMag-std()"       
[35] "tBodyAccJerkMag-mean()"      "tBodyAccJerkMag-std()"      
[37] "tBodyGyroMag-mean()"         "tBodyGyroMag-std()"         
[39] "tBodyGyroJerkMag-mean()"     "tBodyGyroJerkMag-std()"     
[41] "fBodyAcc-mean()-X"           "fBodyAcc-mean()-Y"          
[43] "fBodyAcc-mean()-Z"           "fBodyAcc-std()-X"           
[45] "fBodyAcc-std()-Y"            "fBodyAcc-std()-Z"           
[47] "fBodyAccJerk-mean()-X"       "fBodyAccJerk-mean()-Y"      
[49] "fBodyAccJerk-mean()-Z"       "fBodyAccJerk-std()-X"       
[51] "fBodyAccJerk-std()-Y"        "fBodyAccJerk-std()-Z"       
[53] "fBodyGyro-mean()-X"          "fBodyGyro-mean()-Y"         
[55] "fBodyGyro-mean()-Z"          "fBodyGyro-std()-X"          
[57] "fBodyGyro-std()-Y"           "fBodyGyro-std()-Z"          
[59] "fBodyAccMag-mean()"          "fBodyAccMag-std()"          
[61] "fBodyBodyAccJerkMag-mean()"  "fBodyBodyAccJerkMag-std()"  
[63] "fBodyBodyGyroMag-mean()"     "fBodyBodyGyroMag-std()"     
[65] "fBodyBodyGyroJerkMag-mean()" "fBodyBodyGyroJerkMag-std()" 
```

## Analysis process

The analysis file is saved as ```run_analysis.R```. The followings are some main codes in the file:

* Merges the training and the test sets to create one data set.
```{r}
subject <- rbind(subject_train, subject_test)
setnames(subject, 'V1', 'subject')

activity <- rbind(activity_train, activity_test)
setnames(activity, 'V1', 'activityNum')

result <- rbind(result_train, result_test)

data <- cbind(subject, activity, result)
```
* Extracts only the measurements on the mean and standard deviation for each measurement.
```{r}
feature <- feature[grep('mean\\(\\)|std\\(\\)', featureName)]
select <- c('subject', 'activityNum', paste0('V', feature$featureNum))
data <- subset(data, select = select)
```
* Uses descriptive activity names to name the activities in the data set.
```{r}
data <- merge(data, activity_labels, by = 'activityNum', all = T)
```
* Appropriately labels the data set with descriptive variable names.
```{r}
setnames(data, paste0('V', feature$featureNum), feature$featureName)
```
* From the data set in previous step, creates a second, independent tidy data set with the average of each variable for each activity and each subject.
```{r}
split_subject <- split(data, data$subject)

for(i in 1:length(split_subject)){
    temp <- split_subject[[i]]
    temp <- temp[, 3:ncol(temp), with = F]
    temp <- aggregate(. ~ activityName, temp, mean)
    # calculate mean of each feature grouping by activityName
    temp <- data.table(temp)
    temp <- cbind(i, temp)
    setnames(temp, names(temp)[1], 'subject')
    mean_data <- rbind(mean_data, temp)
}
```

After ruuning the analysis, there are two data sets saved in csv files:
* The cleaned data with measurements on the mean and standard deviation for each measurement saved in ```cleaned_data.csv```
* The average of each variable for each activity and each subject calculated from previous data saved in ```mean_variables_per_activity_subject.csv```

## Data structure

The cleaned data with measurements on the mean and standard deviation for each measurement
```{r}
str(data)
```
```{r}
Classes ‘data.table’ and 'data.frame':    10299 obs. of  69 variables:
 $ activityNum                : int  1 1 1 1 1 1 1 1 1 1 ...
 $ subject                    : Factor w/ 30 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ tBodyAcc-mean()-X          : num  0.282 0.256 0.255 0.343 0.276 ...
 $ tBodyAcc-mean()-Y          : num  -0.0377 -0.06455 0.00381 -0.01445 -0.02964 ...
 $ tBodyAcc-mean()-Z          : num  -0.1349 -0.0952 -0.1237 -0.1674 -0.1426 ...
 $ tBodyAcc-std()-X           : num  -0.328 -0.229 -0.275 -0.23 -0.227 ...
 $ tBodyAcc-std()-Y           : num  -0.1372 0.0165 0.0131 0.1739 0.1643 ...
 $ tBodyAcc-std()-Z           : num  -0.189 -0.26 -0.284 -0.213 -0.123 ...
 $ tGravityAcc-mean()-X       : num  0.945 0.941 0.946 0.952 0.947 ...
 $ tGravityAcc-mean()-Y       : num  -0.246 -0.252 -0.264 -0.26 -0.257 ...
 $ tGravityAcc-mean()-Z       : num  -0.0322 -0.0329 -0.0256 -0.0261 -0.0284 ...
 $ tGravityAcc-std()-X        : num  -0.984 -0.984 -0.963 -0.981 -0.977 ...
 $ tGravityAcc-std()-Y        : num  -0.929 -0.917 -0.956 -0.964 -0.989 ...
 $ tGravityAcc-std()-Z        : num  -0.933 -0.949 -0.972 -0.964 -0.96 ...
 $ tBodyAccJerk-mean()-X      : num  -0.156 -0.208 0.202 0.336 -0.236 ...
 $ tBodyAccJerk-mean()-Y      : num  -0.143 0.358 0.417 -0.464 -0.112 ...
 $ tBodyAccJerk-mean()-Z      : num  -0.11308 -0.4524 0.13908 -0.00503 0.17265 ...
 $ tBodyAccJerk-std()-X       : num  -0.184 -0.108 -0.178 -0.12 -0.192 ...
 $ tBodyAccJerk-std()-Y       : num  -0.1705 -0.0187 -0.0296 0.0287 0.054 ...
 $ tBodyAccJerk-std()-Z       : num  -0.614 -0.548 -0.58 -0.521 -0.469 ...
 $ tBodyGyro-mean()-X         : num  -0.47973 0.09409 0.2112 0.09608 0.00874 ...
 $ tBodyGyro-mean()-Y         : num  0.082 -0.3092 -0.2729 -0.1634 0.0117 ...
 $ tBodyGyro-mean()-Z         : num  0.25644 0.08644 0.10199 0.02586 0.00417 ...
 $ tBodyGyro-std()-X          : num  -0.324 -0.399 -0.445 -0.36 -0.378 ...
 $ tBodyGyro-std()-Y          : num  -0.1419 -0.0884 -0.0631 0.0423 0.1337 ...
 $ tBodyGyro-std()-Z          : num  -0.457 -0.402 -0.347 -0.276 -0.308 ...
 $ tBodyGyroJerk-mean()-X     : num  0.0942 0.1667 -0.1632 -0.0546 -0.0757 ...
 $ tBodyGyroJerk-mean()-Y     : num  -0.47621 -0.0338 -0.00556 0.34029 0.17147 ...
 $ tBodyGyroJerk-mean()-Z     : num  -0.1421 -0.0893 -0.2316 -0.2697 0.1365 ...
 $ tBodyGyroJerk-std()-X      : num  -0.346 -0.25 -0.264 -0.102 -0.129 ...
 $ tBodyGyroJerk-std()-Y      : num  -0.487 -0.454 -0.425 -0.243 -0.19 ...
 $ tBodyGyroJerk-std()-Z      : num  -0.422 -0.37 -0.343 -0.312 -0.418 ...
 $ tBodyAccMag-mean()         : num  -0.2246 -0.1265 -0.1601 -0.0735 -0.0495 ...
 $ tBodyAccMag-std()          : num  -0.238 -0.213 -0.258 -0.195 -0.211 ...
 $ tGravityAccMag-mean()      : num  -0.2246 -0.1265 -0.1601 -0.0735 -0.0495 ...
 $ tGravityAccMag-std()       : num  -0.238 -0.213 -0.258 -0.195 -0.211 ...
 $ tBodyAccJerkMag-mean()     : num  -0.289 -0.139 -0.194 -0.129 -0.16 ...
 $ tBodyAccJerkMag-std()      : num  -0.165 -0.199 -0.22 -0.174 -0.15 ...
 $ tBodyGyroMag-mean()        : num  -0.0344 -0.1409 -0.0946 -0.0493 -0.0214 ...
 $ tBodyGyroMag-std()         : num  -0.1682 -0.2161 -0.2908 -0.0901 -0.0446 ...
 $ tBodyGyroJerkMag-mean()    : num  -0.466 -0.39 -0.374 -0.236 -0.22 ...
 $ tBodyGyroJerkMag-std()     : num  -0.434 -0.439 -0.418 -0.229 -0.213 ...
 $ fBodyAcc-mean()-X          : num  -0.261 -0.151 -0.23 -0.151 -0.226 ...
 $ fBodyAcc-mean()-Y          : num  -0.1226 -0.029 0.0254 0.1953 0.1103 ...
 $ fBodyAcc-mean()-Z          : num  -0.331 -0.257 -0.377 -0.321 -0.205 ...
 $ fBodyAcc-std()-X           : num  -0.357 -0.262 -0.294 -0.263 -0.227 ...
 $ fBodyAcc-std()-Y           : num  -0.1996 -0.0239 -0.0577 0.0879 0.1188 ...
 $ fBodyAcc-std()-Z           : num  -0.178 -0.322 -0.29 -0.217 -0.146 ...
 $ fBodyAccJerk-mean()-X      : num  -0.21 -0.178 -0.193 -0.183 -0.285 ...
 $ fBodyAccJerk-mean()-Y      : num  -0.2635 -0.1208 -0.1096 -0.026 -0.0111 ...
 $ fBodyAccJerk-mean()-Z      : num  -0.536 -0.499 -0.526 -0.487 -0.426 ...
 $ fBodyAccJerk-std()-X       : num  -0.228 -0.114 -0.236 -0.132 -0.169 ...
 $ fBodyAccJerk-std()-Y       : num  -0.12427 0.02785 -0.00582 0.02037 0.05578 ...
 $ fBodyAccJerk-std()-Z       : num  -0.698 -0.595 -0.633 -0.553 -0.51 ...
 $ fBodyGyro-mean()-X         : num  -0.185 -0.205 -0.317 -0.162 -0.237 ...
 $ fBodyGyro-mean()-Y         : num  -0.198 -0.2458 -0.2082 0.0266 0.0472 ...
 $ fBodyGyro-mean()-Z         : num  -0.308 -0.311 -0.186 -0.18 -0.258 ...
 $ fBodyGyro-std()-X          : num  -0.368 -0.461 -0.486 -0.423 -0.422 ...
 $ fBodyGyro-std()-Y          : num  -0.11505 -0.00984 0.00973 0.04465 0.17602 ...
 $ fBodyGyro-std()-Z          : num  -0.565 -0.49 -0.469 -0.377 -0.389 ...
 $ fBodyAccMag-mean()         : num  -0.1668 -0.0793 -0.1563 -0.1044 -0.1232 ...
 $ fBodyAccMag-std()          : num  -0.4 -0.423 -0.437 -0.376 -0.388 ...
 $ fBodyBodyAccJerkMag-mean() : num  -0.154 -0.178 -0.149 -0.132 -0.116 ...
 $ fBodyBodyAccJerkMag-std()  : num  -0.185 -0.231 -0.321 -0.233 -0.201 ...
 $ fBodyBodyGyroMag-mean()    : num  -0.22218 -0.26828 -0.30867 -0.06013 -0.00382 ...
 $ fBodyBodyGyroMag-std()     : num  -0.274 -0.315 -0.401 -0.275 -0.246 ...
 $ fBodyBodyGyroJerkMag-mean(): num  -0.432 -0.428 -0.401 -0.218 -0.188 ...
 $ fBodyBodyGyroJerkMag-std() : num  -0.476 -0.493 -0.482 -0.299 -0.3 ...
 $ activityName               : Factor w/ 6 levels "LAYING","SITTING",..: 4 4 4 4 4 4 4 4 4 4 ...
```

The average of each variable for each activity and each subject calculated from previous data
```{r}
str(mean_data)
```
```{r}
Classes ‘data.table’ and 'data.frame':	180 obs. of  68 variables:
 $ subject                    : int  1 1 1 1 1 1 2 2 2 2 ...
 $ activityName               : Factor w/ 6 levels "LAYING","SITTING",..: 1 2 3 4 5 6 1 2 3 4 ...
 $ tBodyAcc-mean()-X          : num  0.222 0.261 0.279 0.277 0.289 ...
 $ tBodyAcc-mean()-Y          : num  -0.04051 -0.00131 -0.01614 -0.01738 -0.00992 ...
 $ tBodyAcc-mean()-Z          : num  -0.113 -0.105 -0.111 -0.111 -0.108 ...
 $ tBodyAcc-std()-X           : num  -0.928 -0.977 -0.996 -0.284 0.03 ...
 $ tBodyAcc-std()-Y           : num  -0.8368 -0.9226 -0.9732 0.1145 -0.0319 ...
 $ tBodyAcc-std()-Z           : num  -0.826 -0.94 -0.98 -0.26 -0.23 ...
 $ tGravityAcc-mean()-X       : num  -0.249 0.832 0.943 0.935 0.932 ...
 $ tGravityAcc-mean()-Y       : num  0.706 0.204 -0.273 -0.282 -0.267 ...
 $ tGravityAcc-mean()-Z       : num  0.4458 0.332 0.0135 -0.0681 -0.0621 ...
 $ tGravityAcc-std()-X        : num  -0.897 -0.968 -0.994 -0.977 -0.951 ...
 $ tGravityAcc-std()-Y        : num  -0.908 -0.936 -0.981 -0.971 -0.937 ...
 $ tGravityAcc-std()-Z        : num  -0.852 -0.949 -0.976 -0.948 -0.896 ...
 $ tBodyAccJerk-mean()-X      : num  0.0811 0.0775 0.0754 0.074 0.0542 ...
 $ tBodyAccJerk-mean()-Y      : num  0.003838 -0.000619 0.007976 0.028272 0.02965 ...
 $ tBodyAccJerk-mean()-Z      : num  0.01083 -0.00337 -0.00369 -0.00417 -0.01097 ...
 $ tBodyAccJerk-std()-X       : num  -0.9585 -0.9864 -0.9946 -0.1136 -0.0123 ...
 $ tBodyAccJerk-std()-Y       : num  -0.924 -0.981 -0.986 0.067 -0.102 ...
 $ tBodyAccJerk-std()-Z       : num  -0.955 -0.988 -0.992 -0.503 -0.346 ...
 $ tBodyGyro-mean()-X         : num  -0.0166 -0.0454 -0.024 -0.0418 -0.0351 ...
 $ tBodyGyro-mean()-Y         : num  -0.0645 -0.0919 -0.0594 -0.0695 -0.0909 ...
 $ tBodyGyro-mean()-Z         : num  0.1487 0.0629 0.0748 0.0849 0.0901 ...
 $ tBodyGyro-std()-X          : num  -0.874 -0.977 -0.987 -0.474 -0.458 ...
 $ tBodyGyro-std()-Y          : num  -0.9511 -0.9665 -0.9877 -0.0546 -0.1263 ...
 $ tBodyGyro-std()-Z          : num  -0.908 -0.941 -0.981 -0.344 -0.125 ...
 $ tBodyGyroJerk-mean()-X     : num  -0.1073 -0.0937 -0.0996 -0.09 -0.074 ...
 $ tBodyGyroJerk-mean()-Y     : num  -0.0415 -0.0402 -0.0441 -0.0398 -0.044 ...
 $ tBodyGyroJerk-mean()-Z     : num  -0.0741 -0.0467 -0.049 -0.0461 -0.027 ...
 $ tBodyGyroJerk-std()-X      : num  -0.919 -0.992 -0.993 -0.207 -0.487 ...
 $ tBodyGyroJerk-std()-Y      : num  -0.968 -0.99 -0.995 -0.304 -0.239 ...
 $ tBodyGyroJerk-std()-Z      : num  -0.958 -0.988 -0.992 -0.404 -0.269 ...
 $ tBodyAccMag-mean()         : num  -0.8419 -0.9485 -0.9843 -0.137 0.0272 ...
 $ tBodyAccMag-std()          : num  -0.7951 -0.9271 -0.9819 -0.2197 0.0199 ...
 $ tGravityAccMag-mean()      : num  -0.8419 -0.9485 -0.9843 -0.137 0.0272 ...
 $ tGravityAccMag-std()       : num  -0.7951 -0.9271 -0.9819 -0.2197 0.0199 ...
 $ tBodyAccJerkMag-mean()     : num  -0.9544 -0.9874 -0.9924 -0.1414 -0.0894 ...
 $ tBodyAccJerkMag-std()      : num  -0.9282 -0.9841 -0.9931 -0.0745 -0.0258 ...
 $ tBodyGyroMag-mean()        : num  -0.8748 -0.9309 -0.9765 -0.161 -0.0757 ...
 $ tBodyGyroMag-std()         : num  -0.819 -0.935 -0.979 -0.187 -0.226 ...
 $ tBodyGyroJerkMag-mean()    : num  -0.963 -0.992 -0.995 -0.299 -0.295 ...
 $ tBodyGyroJerkMag-std()     : num  -0.936 -0.988 -0.995 -0.325 -0.307 ...
 $ fBodyAcc-mean()-X          : num  -0.9391 -0.9796 -0.9952 -0.2028 0.0382 ...
 $ fBodyAcc-mean()-Y          : num  -0.86707 -0.94408 -0.97707 0.08971 0.00155 ...
 $ fBodyAcc-mean()-Z          : num  -0.883 -0.959 -0.985 -0.332 -0.226 ...
 $ fBodyAcc-std()-X           : num  -0.9244 -0.9764 -0.996 -0.3191 0.0243 ...
 $ fBodyAcc-std()-Y           : num  -0.834 -0.917 -0.972 0.056 -0.113 ...
 $ fBodyAcc-std()-Z           : num  -0.813 -0.934 -0.978 -0.28 -0.298 ...
 $ fBodyAccJerk-mean()-X      : num  -0.9571 -0.9866 -0.9946 -0.1705 -0.0277 ...
 $ fBodyAccJerk-mean()-Y      : num  -0.9225 -0.9816 -0.9854 -0.0352 -0.1287 ...
 $ fBodyAccJerk-mean()-Z      : num  -0.948 -0.986 -0.991 -0.469 -0.288 ...
 $ fBodyAccJerk-std()-X       : num  -0.9642 -0.9875 -0.9951 -0.1336 -0.0863 ...
 $ fBodyAccJerk-std()-Y       : num  -0.932 -0.983 -0.987 0.107 -0.135 ...
 $ fBodyAccJerk-std()-Z       : num  -0.961 -0.988 -0.992 -0.535 -0.402 ...
 $ fBodyGyro-mean()-X         : num  -0.85 -0.976 -0.986 -0.339 -0.352 ...
 $ fBodyGyro-mean()-Y         : num  -0.9522 -0.9758 -0.989 -0.1031 -0.0557 ...
 $ fBodyGyro-mean()-Z         : num  -0.9093 -0.9513 -0.9808 -0.2559 -0.0319 ...
 $ fBodyGyro-std()-X          : num  -0.882 -0.978 -0.987 -0.517 -0.495 ...
 $ fBodyGyro-std()-Y          : num  -0.9512 -0.9623 -0.9871 -0.0335 -0.1814 ...
 $ fBodyGyro-std()-Z          : num  -0.917 -0.944 -0.982 -0.437 -0.238 ...
 $ fBodyAccMag-mean()         : num  -0.8618 -0.9478 -0.9854 -0.1286 0.0966 ...
 $ fBodyAccMag-std()          : num  -0.798 -0.928 -0.982 -0.398 -0.187 ...
 $ fBodyBodyAccJerkMag-mean() : num  -0.9333 -0.9853 -0.9925 -0.0571 0.0262 ...
 $ fBodyBodyAccJerkMag-std()  : num  -0.922 -0.982 -0.993 -0.103 -0.104 ...
 $ fBodyBodyGyroMag-mean()    : num  -0.862 -0.958 -0.985 -0.199 -0.186 ...
 $ fBodyBodyGyroMag-std()     : num  -0.824 -0.932 -0.978 -0.321 -0.398 ...
 $ fBodyBodyGyroJerkMag-mean(): num  -0.942 -0.99 -0.995 -0.319 -0.282 ...
 $ fBodyBodyGyroJerkMag-std() : num  -0.933 -0.987 -0.995 -0.382 -0.392 ...
```

## Data at a glance

The cleaned data with measurements on the mean and standard deviation for each measurement
```{r}
head(data, 3)
```
```{r}
   activityNum subject tBodyAcc-mean()-X tBodyAcc-mean()-Y tBodyAcc-mean()-Z
1:           1       1         0.2820216      -0.037696218       -0.13489730
2:           1       1         0.2558408      -0.064550029       -0.09518634
3:           1       1         0.2548672       0.003814723       -0.12365809
   tBodyAcc-std()-X tBodyAcc-std()-Y tBodyAcc-std()-Z tGravityAcc-mean()-X
1:       -0.3282802      -0.13715339       -0.1890859            0.9453028
2:       -0.2292069       0.01650608       -0.2603109            0.9411130
3:       -0.2751579       0.01307987       -0.2843713            0.9463639
   tGravityAcc-mean()-Y tGravityAcc-mean()-Z tGravityAcc-std()-X
1:           -0.2459414          -0.03216478          -0.9840476
2:           -0.2520352          -0.03288345          -0.9839625
3:           -0.2642781          -0.02557507          -0.9628101
   tGravityAcc-std()-Y tGravityAcc-std()-Z tBodyAccJerk-mean()-X
1:          -0.9289281          -0.9325598            -0.1564857
2:          -0.9174993          -0.9490782            -0.2075541
3:          -0.9561309          -0.9719092             0.2016045
   tBodyAccJerk-mean()-Y tBodyAccJerk-mean()-Z tBodyAccJerk-std()-X
1:            -0.1428530            -0.1130787           -0.1837594
2:             0.3578428            -0.4524009           -0.1083503
3:             0.4170823             0.1390782           -0.1776946
   tBodyAccJerk-std()-Y tBodyAccJerk-std()-Z tBodyGyro-mean()-X
1:          -0.17046131           -0.6138299        -0.47972952
2:          -0.01869285           -0.5475588         0.09409148
3:          -0.02960064           -0.5795071         0.21120057
   tBodyGyro-mean()-Y tBodyGyro-mean()-Z tBodyGyro-std()-X tBodyGyro-std()-Y
1:         0.08203403         0.25644309        -0.3235458       -0.14193972
2:        -0.30915291         0.08644117        -0.3992529       -0.08841570
3:        -0.27290542         0.10198601        -0.4454378       -0.06308333
   tBodyGyro-std()-Z tBodyGyroJerk-mean()-X tBodyGyroJerk-mean()-Y
1:        -0.4565980             0.09424803           -0.476210050
2:        -0.4021575             0.16674262           -0.033796125
3:        -0.3470558            -0.16322550           -0.005560408
   tBodyGyroJerk-mean()-Z tBodyGyroJerk-std()-X tBodyGyroJerk-std()-Y
1:            -0.14213364            -0.3457161            -0.4867495
2:            -0.08926024            -0.2498919            -0.4537442
3:            -0.23155479            -0.2642317            -0.4246765
   tBodyGyroJerk-std()-Z tBodyAccMag-mean() tBodyAccMag-std()
1:            -0.4215080         -0.2245596        -0.2379807
2:            -0.3698131         -0.1265027        -0.2133903
3:            -0.3425422         -0.1601000        -0.2575711
   tGravityAccMag-mean() tGravityAccMag-std() tBodyAccJerkMag-mean()
1:            -0.2245596           -0.2379807             -0.2894243
2:            -0.1265027           -0.2133903             -0.1385012
3:            -0.1601000           -0.2575711             -0.1943548
   tBodyAccJerkMag-std() tBodyGyroMag-mean() tBodyGyroMag-std()
1:            -0.1650001         -0.03439560         -0.1681863
2:            -0.1985903         -0.14093823         -0.2160552
3:            -0.2199436         -0.09459356         -0.2908474
   tBodyGyroJerkMag-mean() tBodyGyroJerkMag-std() fBodyAcc-mean()-X
1:              -0.4661497             -0.4336540        -0.2609049
2:              -0.3899198             -0.4389841        -0.1511153
3:              -0.3741507             -0.4180319        -0.2304074
   fBodyAcc-mean()-Y fBodyAcc-mean()-Z fBodyAcc-std()-X fBodyAcc-std()-Y
1:       -0.12256680        -0.3312160       -0.3567070      -0.19956719
2:       -0.02904997        -0.2573071       -0.2621973      -0.02385785
3:        0.02542685        -0.3773113       -0.2935223      -0.05769317
   fBodyAcc-std()-Z fBodyAccJerk-mean()-X fBodyAccJerk-mean()-Y
1:       -0.1777802            -0.2104645            -0.2635281
2:       -0.3221639            -0.1783384            -0.1208388
3:       -0.2900854            -0.1926535            -0.1096107
   fBodyAccJerk-mean()-Z fBodyAccJerk-std()-X fBodyAccJerk-std()-Y
1:            -0.5357091           -0.2282532         -0.124274450
2:            -0.4989475           -0.1140450          0.027847600
3:            -0.5256478           -0.2358945         -0.005815575
   fBodyAccJerk-std()-Z fBodyGyro-mean()-X fBodyGyro-mean()-Y fBodyGyro-mean()-Z
1:           -0.6984362         -0.1847807         -0.1980244         -0.3075584
2:           -0.5945946         -0.2045095         -0.2458314         -0.3111780
3:           -0.6328668         -0.3170815         -0.2081588         -0.1857984
   fBodyGyro-std()-X fBodyGyro-std()-Y fBodyGyro-std()-Z fBodyAccMag-mean()
1:        -0.3680772      -0.115047260        -0.5653109        -0.16681083
2:        -0.4613169      -0.009837662        -0.4898550        -0.07927762
3:        -0.4863059       0.009726873        -0.4693567        -0.15631258
   fBodyAccMag-std() fBodyBodyAccJerkMag-mean() fBodyBodyAccJerkMag-std()
1:        -0.3995829                 -0.1540448                -0.1846900
2:        -0.4230300                 -0.1784456                -0.2306563
3:        -0.4368583                 -0.1494380                -0.3212563
   fBodyBodyGyroMag-mean() fBodyBodyGyroMag-std() fBodyBodyGyroJerkMag-mean()
1:              -0.2221760             -0.2736495                  -0.4318317
2:              -0.2682798             -0.3146234                  -0.4281859
3:              -0.3086707             -0.4014002                  -0.4010383
   fBodyBodyGyroJerkMag-std() activityName
1:                 -0.4763701      WALKING
2:                 -0.4928844      WALKING
3:                 -0.4819242      WALKING
```

The average of each variable for each activity and each subject calculated from previous data
```{r}
head(mean_data, 3)
```
```{r}
   subject activityName tBodyAcc-mean()-X tBodyAcc-mean()-Y tBodyAcc-mean()-Z
1:       1       LAYING         0.2215982      -0.040513953        -0.1132036
2:       1      SITTING         0.2612376      -0.001308288        -0.1045442
3:       1     STANDING         0.2789176      -0.016137590        -0.1106018
   tBodyAcc-std()-X tBodyAcc-std()-Y tBodyAcc-std()-Z tGravityAcc-mean()-X
1:       -0.9280565       -0.8368274       -0.8260614           -0.2488818
2:       -0.9772290       -0.9226186       -0.9395863            0.8315099
3:       -0.9957599       -0.9731901       -0.9797759            0.9429520
   tGravityAcc-mean()-Y tGravityAcc-mean()-Z tGravityAcc-std()-X
1:            0.7055498           0.44581772          -0.8968300
2:            0.2044116           0.33204370          -0.9684571
3:           -0.2729838           0.01349058          -0.9937630
   tGravityAcc-std()-Y tGravityAcc-std()-Z tBodyAccJerk-mean()-X
1:          -0.9077200          -0.8523663            0.08108653
2:          -0.9355171          -0.9490409            0.07748252
3:          -0.9812260          -0.9763241            0.07537665
   tBodyAccJerk-mean()-Y tBodyAccJerk-mean()-Z tBodyAccJerk-std()-X
1:          0.0038382040           0.010834236           -0.9584821
2:         -0.0006191028          -0.003367792           -0.9864307
3:          0.0079757309          -0.003685250           -0.9946045
   tBodyAccJerk-std()-Y tBodyAccJerk-std()-Z tBodyGyro-mean()-X
1:           -0.9241493           -0.9548551        -0.01655309
2:           -0.9813720           -0.9879108        -0.04535006
3:           -0.9856487           -0.9922512        -0.02398773
   tBodyGyro-mean()-Y tBodyGyro-mean()-Z tBodyGyro-std()-X tBodyGyro-std()-Y
1:        -0.06448612         0.14868944        -0.8735439        -0.9510904
2:        -0.09192415         0.06293138        -0.9772113        -0.9664739
3:        -0.05939722         0.07480075        -0.9871919        -0.9877344
   tBodyGyro-std()-Z tBodyGyroJerk-mean()-X tBodyGyroJerk-mean()-Y
1:        -0.9082847            -0.10727095            -0.04151729
2:        -0.9414259            -0.09367938            -0.04021181
3:        -0.9806456            -0.09960921            -0.04406279
   tBodyGyroJerk-mean()-Z tBodyGyroJerk-std()-X tBodyGyroJerk-std()-Y
1:            -0.07405012            -0.9186085            -0.9679072
2:            -0.04670263            -0.9917316            -0.9895181
3:            -0.04895055            -0.9929451            -0.9951379
   tBodyGyroJerk-std()-Z tBodyAccMag-mean() tBodyAccMag-std()
1:            -0.9577902         -0.8419292        -0.7951449
2:            -0.9879358         -0.9485368        -0.9270784
3:            -0.9921085         -0.9842782        -0.9819429
   tGravityAccMag-mean() tGravityAccMag-std() tBodyAccJerkMag-mean()
1:            -0.8419292           -0.7951449             -0.9543963
2:            -0.9485368           -0.9270784             -0.9873642
3:            -0.9842782           -0.9819429             -0.9923678
   tBodyAccJerkMag-std() tBodyGyroMag-mean() tBodyGyroMag-std()
1:            -0.9282456          -0.8747595         -0.8190102
2:            -0.9841200          -0.9308925         -0.9345318
3:            -0.9930962          -0.9764938         -0.9786900
   tBodyGyroJerkMag-mean() tBodyGyroJerkMag-std() fBodyAcc-mean()-X
1:              -0.9634610             -0.9358410        -0.9390991
2:              -0.9919763             -0.9883087        -0.9796412
3:              -0.9949668             -0.9947332        -0.9952499
   fBodyAcc-mean()-Y fBodyAcc-mean()-Z fBodyAcc-std()-X fBodyAcc-std()-Y
1:        -0.8670652        -0.8826669       -0.9244374       -0.8336256
2:        -0.9440846        -0.9591849       -0.9764123       -0.9172750
3:        -0.9770708        -0.9852971       -0.9960283       -0.9722931
   fBodyAcc-std()-Z fBodyAccJerk-mean()-X fBodyAccJerk-mean()-Y
1:       -0.8128916            -0.9570739            -0.9224626
2:       -0.9344696            -0.9865970            -0.9815795
3:       -0.9779373            -0.9946308            -0.9854187
   fBodyAccJerk-mean()-Z fBodyAccJerk-std()-X fBodyAccJerk-std()-Y
1:            -0.9480609           -0.9641607           -0.9322179
2:            -0.9860531           -0.9874930           -0.9825139
3:            -0.9907522           -0.9950738           -0.9870182
   fBodyAccJerk-std()-Z fBodyGyro-mean()-X fBodyGyro-mean()-Y fBodyGyro-mean()-Z
1:           -0.9605870         -0.8502492         -0.9521915         -0.9093027
2:           -0.9883392         -0.9761615         -0.9758386         -0.9513155
3:           -0.9923498         -0.9863868         -0.9889845         -0.9807731
   fBodyGyro-std()-X fBodyGyro-std()-Y fBodyGyro-std()-Z fBodyAccMag-mean()
1:        -0.8822965        -0.9512320        -0.9165825         -0.8617676
2:        -0.9779042        -0.9623450        -0.9439178         -0.9477829
3:        -0.9874971        -0.9871077        -0.9823453         -0.9853564
   fBodyAccMag-std() fBodyBodyAccJerkMag-mean() fBodyBodyAccJerkMag-std()
1:        -0.7983009                 -0.9333004                -0.9218040
2:        -0.9284448                 -0.9852621                -0.9816062
3:        -0.9823138                 -0.9925425                -0.9925360
   fBodyBodyGyroMag-mean() fBodyBodyGyroMag-std() fBodyBodyGyroJerkMag-mean()
1:              -0.8621902             -0.8243194                  -0.9423669
2:              -0.9584356             -0.9321984                  -0.9897975
3:              -0.9846176             -0.9784661                  -0.9948154
   fBodyBodyGyroJerkMag-std()
1:                 -0.9326607
2:                 -0.9870496
3:                 -0.9946711
```
